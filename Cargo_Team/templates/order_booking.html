{% extends 'team_base.html' %}
{% load static %}

<!-- title for the order booking page -->
{% block title %}
Order Booking
{% endblock %}

<!-- css link for order booking page -->
{% block link %}
<link rel="stylesheet"  href="{% static 'team/css/booking.css' %}">
{% endblock %}


<!-- contents for order booking page -->
{% block content %}



<div class="container-fluid px-4">
    
    <ol class="breadcrumb mt-3">
        <li class="breadcrumb-item active">Order Booking</li>
    </ol>
    
    <div class="row mt-5 mb-5">
        <div class="col-lg-1"></div>

        <div class="col-lg-10">
            <!-- shipment booking form section for drop off at shipping center option -->

            <div class="card shadow  mb-5 bg-body-tertiary rounded" style="max-width: 100%;">
                <div class="header p-4">
                    <div class="row g-0">
                        <h5 class="mt-3 mb-3 fw-bold text-white"><i class="fas fa-calendar-plus fs-3"></i><span class="ms-3">Order Booking</span></h5>
                    </div>
                </div>
                <!-- form section -->
                <form action="{% url 'order_booking_save' %}" method="post"  class="needs-validation" novalidate>
                    {% csrf_token %}
                    <div class="customer-details p-5">
                        <h5 class="main-heading fw-bold">Customer Information</h5>
                        <div class="row g-3 mt-3">
                            <div class="col-lg-4 mt-2">
                                <input type="text" class="form-control mt-1 mb-1" name="full_name" placeholder="Full Name" required>
                            </div>
                            <div class="col-lg-4 mt-2">
                                <input type="email" class="form-control mt-1 mb-1" name="email" placeholder="Email" pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$" title="Email should be in the format 'example@gmail.com'" required>
                            </div>
                            <div class="col-lg-4 mt-2">
                                <input type="text" class="form-control mt-1 mb-1" name="contact_number" placeholder="Contact No."  pattern="[7896][0-9]{9}" title="Mobile number should contain 10 digits and start with 7,8,9 or 6." required>
                            </div>
                        </div>
                    </div>

                    <div class="shipment-details p-5">
                        <h5 class="main-heading fw-bold">Shipment Details</h5>
                        <div class="row g-3 mt-3">
                            
                            <div class="col-lg-2">
                                <label for="">Delivery Options</label>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="delivery_option" id="road" value="road" required>
                                    <label class="form-check-label" for="road">Road</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="delivery_option" id="air" value="air">
                                    <label class="form-check-label" for="air">Air</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="delivery_option" id="sea" value="sea">
                                    <label class="form-check-label" for="sea">Sea</label>
                                </div>
                            </div>
                            <div class="col-lg-6"></div>

                        </div>
                        <div class="row g-0 mt-3">
                            <div class="col-lg-2">
                                <label for="">Package Weight</label>
                            </div>
                            <div class="col-lg-4">
                                <input type="number" step=".01" class="form-control mt-1 mb-1" name="package_weight" required>
                            </div>
                        </div>
                        <div class="row g-0 mt-3">
                            <div class="col-lg-2">
                                <label for="">No of Packages</label>
                            </div>
                            <div class="col-lg-4">
                                <input type="number" class="form-control mt-1 mb-1" name="number_of_packages" required>
                            </div>
                        </div>
                        
                        <div class="row g-3 mt-3">
                            
                            <div class="col-lg-2">
                                <label for="">Delivery Type</label>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="delivery_type" id="normal" value="normal" required>
                                    <label class="form-check-label" for="normal">Normal</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="delivery_type" id="speed" value="speed">
                                    <label class="form-check-label" for="speed">Speed</label>
                                </div>
                                
                            </div>
                            <div class="col-lg-6"></div>

                        </div>
                        
                    </div>

                    <div class="address-details p-5">
                        <div class="row">

                            <div class="col-lg-8 mt-lg-2 mt-5">
                                <h5 class="main-heading fw-bold">Delivery Address</h5>
                                <div class="row g-3 mt-3">
                                    <div class="col-lg-12">
                                        <input type="text" class="form-control mt-1 mb-1" name="receiver_name" placeholder="Receiver's Name" required>
                                    </div>
                                </div>
                                <div class="row g-3 mt-3">
                                    <div class="col-lg-12">
                                        <input type="text" class="form-control mt-1 mb-1" name="receiver_address" placeholder="Address" required>
                                    </div>
                                </div>
                                <div class="row g-3 mt-3">
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control mt-1 mb-1" name="receiver_city" placeholder="City" required>
                                    </div>
                                    <div class="col-lg-6">
                                        <input type="number" class="form-control mt-1 mb-1" id="pincode" name="receiver_pincode" placeholder="Pincode" required>
                                        <div id="pincode-result"></div>
                                    </div>
                                </div>
                                <div class="row g-3 mt-3">
                                    <div class="col-lg-12">
                                        <input type="text" class="form-control mt-1 mb-1" name="receiver_state" placeholder="State" required>
                                    </div>
                                </div>
                                <div class="row g-3 mt-3">
                                    <div class="col-lg-12">
                                        <input type="text" class="form-control mt-1 mb-1" name="receiver_country" placeholder="Country" required>
                                    </div>
                                </div>
                                <div class="row g-3 mt-3">
                                    <div class="col-lg-12">
                                        <input type="text" class="form-control mt-1 mb-1" name="receiver_contact_no" placeholder="Contact No."  pattern="[7896][0-9]{9}" title="Mobile number should contain 10 digits and start with 7,8,9 or 6." required>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4"></div>

                        </div>
                    </div>
                    <div class="submit-section p-5">
                        <div class="row g-3 mt-3">
                            <div class="col-lg-4">
                                <button id="submit-button" class="button2" type="submit"><span class="ms-1">Submit</span></button>
                            </div>
                            

                        </div>

                    </div>

                </form>
                
                
            </div>

        </div>
        <div class="col-lg-1"></div>



        
    </div>
    
    
</div>

<!-- code for checking pincode is available -->
<style>
.available{
    color: rgb(29, 173, 0);
    font-style: italic;
    
}
.not-available{
    color: rgb(183, 0, 0);
    font-style: italic;
}   
</style>

<script>
    $(document).ready(function() {
        $('#pincode').on('input', function() {
            var pincode = $(this).val();
            if (pincode.length >= 6) { // Assuming pincode is at least 6 digits long
                $.ajax({
                    url: '{% url "check_pincode" %}',
                    type: 'GET',
                    data: {
                        'pincode': pincode
                    },
                    success: function(data) {
                        if (data.is_available) {
                            $('#pincode-result').text('Serivice is available for this location.').removeClass().addClass('available');
                            $('#submit-button').prop('disabled', false);
                        } else {
                            $('#pincode-result').text('Service  is not available for this location.').removeClass().addClass('not-available');
                            $('#submit-button').prop('disabled', true);
                        }
                    },
                    error: function(xhr, status, error) {
                        $('#pincode-result').text('An error occurred: ' + error);
                        $('#submit-button').prop('disabled', true);
                        
                    }
                });
            } else {
                $('#pincode-result').text('');
                $('#submit-button').prop('disabled', true);
            }
        });
    });
</script>

<script>
    // Example starter JavaScript for disabling form submissions if there are invalid fields
    (() => {
    'use strict'

    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    const forms = document.querySelectorAll('.needs-validation')

    // Loop over them and prevent submission
    Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
        if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
        }

        form.classList.add('was-validated')
        }, false)
    })
    })()
</script>



{% endblock %}
