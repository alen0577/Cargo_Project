<!-- shipment booking form section for home pickup option -->

<div class="card shadow  mb-5 bg-body-tertiary rounded" style="max-width: 100%;">
    <div class="header p-4">
      <div class="row g-0">
        <h5 class="mt-3 mb-3 fw-bold text-white"><i class="fas fa-calendar-plus fs-3"></i><span class="ms-3">Book a Pickup</span></h5>
      </div>
    </div>
    <!-- form section -->
    <form action="{% url 'home_pickup_booking' %}" method="post" class="needs-validation" novalidate>
        {% csrf_token %}
        <div class="customer-details p-5">
            <h5 class="main-heading fw-bold">Your Information</h5>
            <div class="row g-3 mt-3">
                <div class="col-lg-4 mt-2">
                    <input type="text" class="form-control mt-1 mb-1" name="full_name" placeholder="Full Name" required>
                </div>
                <div class="col-lg-4 mt-2">
                    <input type="email" class="form-control mt-1 mb-1" name="email" placeholder="Email" pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$" title="Email should be in the format 'example@gmail.com'" required>
                </div>
                <div class="col-lg-4 mt-2">
                    <input type="text" class="form-control mt-1 mb-1" name="contact_number" placeholder="Contact No." pattern="[7896][0-9]{9}" title="Mobile number should contain 10 digits and start with 7,8,9 or 6." required>
                </div>
            </div>
        </div>

        <div class="shipment-details p-5">
            <h5 class="main-heading fw-bold">Shipment Details</h5>
            <div class="row g-3 mt-3">
                
                <div class="col-lg-2">
                    <label for="">Delivery Options</label>
                </div>
                <div class="col-lg-4">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="delivery_option" id="road" value="road" required>
                        <label class="form-check-label" for="road">Road</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="delivery_option" id="air" value="air">
                        <label class="form-check-label" for="air">Air</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="delivery_option" id="sea" value="sea">
                        <label class="form-check-label" for="sea">Sea</label>
                    </div>
                </div>
                <div class="col-lg-6"></div>

            </div>
            <div class="row g-0 mt-3">
                <div class="col-lg-2">
                    <label for="">Package Weight</label>
                </div>
                <div class="col-lg-4">
                    <input type="number" step="0.01" class="form-control mt-1 mb-1"  name="package_weight" >
                </div>
            </div>
            <div class="row g-0 mt-3">
                <div class="col-lg-2">
                    <label for="">No of Packages</label>
                </div>
                <div class="col-lg-4">
                    <input type="number" class="form-control mt-1 mb-1" name="number_of_packages" >
                </div>
            </div>
            
            <div class="row g-3 mt-3">
                
                <div class="col-lg-2">
                    <label for="">Delivery Type</label>
                </div>
                <div class="col-lg-4">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="delivery_type" id="normal" value="normal" required>
                        <label class="form-check-label" for="normal">Normal</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="delivery_type" id="speed" value="speed">
                        <label class="form-check-label" for="speed">Speed</label>
                    </div>
                      
                </div>
                <div class="col-lg-6"></div>

            </div>
            <div class="row g-0 mt-3">
                <div class="col-lg-2">
                    <label for="">Shipping Center</label>
                </div>
                <div class="col-lg-4">
                    <select name="center-select" class="form-select mt-1 mb-1" required>
                        <option value="" hidden>Select</option>
                        {% for i in city %}
                        <option value="{{i.id}}">{{i.name}}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
        </div>

        <div class="address-details p-5">
            <div class="row">

                <div class="col-lg-5 mt-lg-2">
                    <h5 class="main-heading fw-bold">Pickup Address</h5>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="sender_name" placeholder="Sender's Name" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="sender_address" placeholder="Shipment Pickup Address" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-6">
                            <input type="text" class="form-control mt-1 mb-1" name="sender_city" placeholder="City" required>
                        </div>
                        <div class="col-lg-6">
                            <input id="sender-pincode" type="number" class="form-control mt-1 mb-1" name="sender_pincode" placeholder="Pincode" required>
                            <div id="sender-pincode-result"></div>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="sender_state" placeholder="State" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="sender_country" placeholder="Country" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="sender_contact_no" placeholder="Contact No." pattern="[7896][0-9]{9}" title="Mobile number should contain 10 digits and start with 7,8,9 or 6." required>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2"></div>
                <div class="col-lg-5 mt-lg-2 mt-5">
                    <h5 class="main-heading fw-bold">Delivery Address</h5>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="receiver_name" placeholder="Receiver's Name" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="receiver_address" placeholder="Shipment Delivery Address" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-6">
                            <input type="text" class="form-control mt-1 mb-1" name="receiver_city" placeholder="City" required>
                        </div>
                        <div class="col-lg-6">
                            <input id="receiver-pincode" type="number" class="form-control mt-1 mb-1" name="receiver_pincode" placeholder="Pincode" required>
                            <div id="receiver-pincode-result"></div>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="receiver_state" placeholder="State" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="receiver_country" placeholder="Country" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-3">
                        <div class="col-lg-12">
                            <input type="text" class="form-control mt-1 mb-1" name="receiver_contact_no" placeholder="Contact No." pattern="[7896][0-9]{9}" title="Mobile number should contain 10 digits and start with 7,8,9 or 6." required>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="submit-section p-5">
            <div class="row g-3 mt-3">
                <div class="col-lg-4">
                    <button id="submit-button" class="button2" type="submit"><span class="ms-1">Submit</span></button>
                </div>
                

            </div>

        </div>

    </form>
    
    
</div>




<!-- code for checking pincode is available -->
<style>
    .available{
        color: rgb(29, 173, 0);
        font-style: italic;
        
    }
    .not-available{
        color: rgb(183, 0, 0);
        font-style: italic;
    }   
    </style>
    
    <script>
        $(document).ready(function() {
            function checkPincode(pincode, resultDiv, callback) {
                if (pincode.length >= 6) {
                    $.ajax({
                        url: '{% url "check_pincode" %}',
                        type: 'GET',
                        data: {
                            'pincode': pincode
                        },
                        success: function(data) {
                            if (data.is_available) {
                                $(resultDiv).text('Service is available.')
                                    .removeClass()
                                    .addClass('available');
                                callback(true);
                            } else {
                                $(resultDiv).text('Service is not available.')
                                    .removeClass()
                                    .addClass('not-available');
                                callback(false);
                            }
                        },
                        error: function(xhr, status, error) {
                            $(resultDiv).text('An error occurred: ' + error)
                                .removeClass()
                                .addClass('error');
                            callback(false);
                        }
                    });
                } else {
                    $(resultDiv).text('').removeClass();
                    callback(false);
                }
            }

            function validateForm() {
                const senderPincodeValid = $('#sender-pincode').data('is-valid');
                const receiverPincodeValid = $('#receiver-pincode').data('is-valid');
                if (senderPincodeValid && receiverPincodeValid) {
                    $('#submit-button').prop('disabled', false);
                } else {
                    $('#submit-button').prop('disabled', true);
                }
            }

            $('#sender-pincode').on('input', function() {
                const pincode = $(this).val();
                checkPincode(pincode, '#sender-pincode-result', function(isValid) {
                    $('#sender-pincode').data('is-valid', isValid);
                    validateForm();
                });
            });

            $('#receiver-pincode').on('input', function() {
                const pincode = $(this).val();
                checkPincode(pincode, '#receiver-pincode-result', function(isValid) {
                    $('#receiver-pincode').data('is-valid', isValid);
                    validateForm();
                });
            });

            // Initialize pincode validation data attributes
            $('#sender-pincode').data('is-valid', false);
            $('#receiver-pincode').data('is-valid', false);
        });
    </script>



<script>
    // Example starter JavaScript for disabling form submissions if there are invalid fields
    (() => {
    'use strict'

    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    const forms = document.querySelectorAll('.needs-validation')

    // Loop over them and prevent submission
    Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
        if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
        }

        form.classList.add('was-validated')
        }, false)
    })
    })()
</script>